# Table of the estimated temporal average effects
table(ce, type = "norm", stat = "avg", horizon = horizon)
library(CausalArima)
y <- rnorm(800, sd = 3)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 2)
x2 <- rnorm(800, mean = 3, sd = 1)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.35
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 7), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Table of the estimated temporal average effects
table(ce, type = "norm", stat = "avg", horizon = horizon)
library(CausalArima)
library(CausalArima)
y <- rnorm(800, sd = 3)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 2)
x2 <- rnorm(800, mean = 3, sd = 1)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.35
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 7), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Table of the estimated temporal average effects
Artable(ce, type = "norm", stat = "avg", horizon = horizon)
library(CausalArima)
y <- rnorm(800, sd = 3)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 2)
x2 <- rnorm(800, mean = 3, sd = 1)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.35
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 7), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
funnyname(ce, type = "norm", stat = "avg", horizon = horizon)
funnyname <- function(x, type = "norm", stat = "avg", direction = "b", horizon = NULL, digits = 2){
UseMethod("funnyname")
}
funnyname(ce, type = "norm", stat = "avg", horizon = horizon)
funnyname.cArima <- function(x, type = "norm", stat = "avg", direction = "b", horizon = NULL, digits = 2){
# param checks
if(class(x) != "cArima") stop ("`x` must be an object of class cArima")
if(!missing(horizon) && !any(class(horizon) %in% c("Date", "POSIXct", "POSIXlt", "POSIXt")))
stop("`horizon` must be a Date object")
if(!(type %in% c("norm", "boot"))) stop("allowed 'type' values are 'norm' or 'boot'")
if(length(x$boot) ==0 & type == "boot") stop("no bootstrap estimates to table, please check CausalArima 'nboot' parameter")
if(!stat %in% c("tau", "sum", "avg")) stop("allowed 'stat' values are 'tau', 'sum', 'avg'")
if(!direction %in% c("l", "b", "r")) stop("allowed 'direction' values are 'l', 'b', 'r'")
# Settings
if(stat %in% c("sum", "avg")){
stat2 <- paste(stat, ".tau", sep = "")
} else {
stat2 <- stat
}
if(is.null(horizon)){ horizon <- tail(x$dates, 1)}
tab <- matrix(NA, nrow = 1, ncol = length(horizon))
colnames(tab) <- paste(horizon)
rownames(tab) <- paste(stat2)
star. <- .star(summary(x, type = type, horizon = horizon)[, paste("pvalue.", stat, ".", direction, sep = "")])
# Table
tab[1,] <- paste(round(summary(x, type = type, horizon = horizon)[, paste(stat2)], digits = digits), "^{", star., "}", sep="" )
tab[1,] <- gsub(tab[1,], pattern = "\\^\\{ \\}", replacement = "")
if(type == "norm"){
tab <- rbind(tab, sd = paste("(",round(summary(x, type = type, horizon = horizon)[, paste("sd.", stat, sep = "")], digits = digits),")", sep = ""))
}
noquote(tab)
}
funnyname(ce, type = "norm", stat = "avg", horizon = horizon)
source("~/GitHub/CausalArima/R/table_arima.R")
funnyname(ce, type = "norm", stat = "avg", horizon = horizon)
library(CausalArima)
rm(list=ls())
library(CausalArima)
y <- rnorm(800, sd = 3)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 2)
x2 <- rnorm(800, mean = 3, sd = 1)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.35
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 7), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
funnyname(ce, type = "norm", stat = "avg", horizon = horizon)
funnyname <- function(x){
UseMethod("funnyname")
}
funnyname(ce, type = "norm", stat = "avg", horizon = horizon)
library(CausalArima)
rm(list=ls())
library(CausalArima)
y <- rnorm(800, sd = 3)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 2)
x2 <- rnorm(800, mean = 3, sd = 1)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.35
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 7), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
funnyname(ce, type = "norm", stat = "avg", horizon = horizon)
library(CausalArima)
funnyname(ce)
funnyname(ce, type = "norm", stat = "avg", horizon = horizon)
library(CausalArima)
rm(list = ls())
y <- rnorm(800, sd = 3)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 2)
x2 <- rnorm(800, mean = 3, sd = 1)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.35
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 7), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Table of the estimated temporal average effects
table(ce, type = "norm", stat = "avg", horizon = horizon)
library(CausalArima)
y <- rnorm(800, sd = 3)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 2)
x2 <- rnorm(800, mean = 3, sd = 1)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.35
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 7), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Table of the estimated temporal average effects
table(ce, type = "norm", stat = "avg", horizon = horizon)
library(CausalArima)
rm(list = ls())
y <- rnorm(800, sd = 3)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 2)
x2 <- rnorm(800, mean = 3, sd = 1)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.35
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 7), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Table of the estimated temporal average effects
table(ce, type = "norm", stat = "avg", horizon = horizon)
installed.packages("CausalImpact")
install.packages("CausalImpact")
urca::show
library(CausalArima)
rm(list = ls())
method(table)
methods(table)
tabulate
library(CausalArima)
rm(list = ls())
y <- rnorm(800, sd = 3)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 2)
x2 <- rnorm(800, mean = 3, sd = 1)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.35
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 7), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Table of the estimated temporal average effects
table(ce, type = "norm", stat = "avg", horizon = horizon)
summary(ce, type = "norm", stat = "avg", direction = "b", horizon = horizon)
summary(ce, horizon = horizon)
stat <- c("avg", "sum")
summary(x, horizon = horizon)[, paste("pvalue.", stat, ".", "b", sep = "")]
summary(ce, horizon = horizon)[, paste("pvalue.", stat, ".", "b", sep = "")]
prova <- summary(ce, horizon = horizon)[, paste("pvalue.", stat, ".", "b", sep = "")]
apply(prova, FUN = ".star")
.star <- function(pvalue){
star <- rep(NA, times = length(pvalue))
ind  <- abs(pvalue) < 0.001
ind2 <- abs(pvalue) < 0.01 & abs(pvalue) >= 0.001
ind3 <- abs(pvalue) < 0.05 & abs(pvalue) >= 0.01
ind4 <- abs(pvalue) < 0.1 &  abs(pvalue) >= 0.05
star[ind] <- "***" ; star[ind2] <- "**" ; star[ind3]<- "*"
star[ind4] <- "." ; star[!ind & !ind2 & !ind3 & !ind4] <- " "
star
}
apply(prova, FUN = ".star")
apply(prova, 2, FUN = ".star")
if(stat %in% c("sum", "avg")){
stat2 <- paste(stat, ".tau", sep = "")
} else {
stat2 <- stat
}
stat2 <- paste0(stat, ".tau", sep = "")
stat2
round(summary(ce,, horizon = horizon)[, paste(stat2)], digits = 2)
apply(prova, 2, FUN = ".star")
m <- apply(prova, 2, FUN = ".star")
paste(round(summary(ce,, horizon = horizon)[, paste(stat2)], digits = 2), m)
m
paste0(round(summary(ce,, horizon = horizon)[, paste(stat2)], digits = 2), m)
apply(round(summary(ce,, horizon = horizon)[, paste(stat2)], digits = 2), 2, FUN = function(x){paste0(x, m)})
library(CausalArima)
y <- rnorm(800, sd = 3)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 2)
x2 <- rnorm(800, mean = 3, sd = 1)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.35
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 7), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Table of the estimated temporal average effects
table(ce, type = "norm", stat = "avg", horizon = horizon)
library(CausalArima)
y <- rnorm(800, sd = 3)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 2)
x2 <- rnorm(800, mean = 3, sd = 1)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.35
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 7), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Table of the estimated temporal average effects
table(ce, type = "norm", stat = "avg", horizon = horizon)
sumry <- summary(ce, horizon = horizon)[, paste("pvalue.", stat, ".", "b", sep = "")]
sumry
summary(ce, horizon = horizon)[, paste(stat)]
t(summary(ce, horizon = horizon)[, paste(stat)])
round(t(summary(ce, horizon = horizon)[, paste(stat)]), digits = 2)
paste0(stat, ".sd")
order(stat, paste0(stat, ".sd"))
c(stat, paste0(stat, ".sd"))
order(c(stat, paste0(stat, ".sd"), decreasing = T)
)
star. <- apply(sumry, 2, FUN = ".star")
star.
effects <- round(summary(ce, horizon = horizon)[, paste(stat)], digits = digits)
effects <- round(summary(ce, horizon = horizon)[, paste(stat)], digits = 2)
effects
tab <- matrix(NA, nrow = 2*length(stat), ncol = length(horizon))
paste(effects[,1], star.[,1])
i <- 1
for(i in 1:length(stat)){
tab[i,] <- paste(effects[, i], "^{", star.[, i], "}", sep="" )
tab[i +1, ] <- paste("(",round(summary(x, type = type, horizon = horizon)[, paste("sd.", stat[i], sep = "")], digits = digits),")", sep = ""))
}
for(i in 1:length(stat)){
tab[i,] <- paste(effects[, i], "^{", star.[, i], "}", sep="" )
tab[i +1, ] <- paste("(",round(summary(x, type = type, horizon = horizon)[, paste("sd.", stat[i], sep = "")], digits = digits),")", sep = "")
}
x <- ce
for(i in 1:length(stat)){
tab[i,] <- paste(effects[, i], "^{", star.[, i], "}", sep="" )
tab[i +1, ] <- paste("(",round(summary(x, type = type, horizon = horizon)[, paste("sd.", stat[i], sep = "")], digits = digits),")", sep = "")
}
type = "norm"
for(i in 1:length(stat)){
tab[i,] <- paste(effects[, i], "^{", star.[, i], "}", sep="" )
tab[i +1, ] <- paste("(",round(summary(x, type = type, horizon = horizon)[, paste("sd.", stat[i], sep = "")], digits = digits),")", sep = "")
}
digits <-2
for(i in 1:length(stat)){
tab[i,] <- paste(effects[, i], "^{", star.[, i], "}", sep="" )
tab[i +1, ] <- paste("(",round(summary(x, type = type, horizon = horizon)[, paste("sd.", stat[i], sep = "")], digits = digits),")", sep = "")
}
tab
seq_len(star.)
seq_len(nrow(star.))
seq_len(nrow(star.))%%2
seq_len(nrow(star.))%/%2
seq_len(nrow(star.))%%2
even <- seq_len(nrow(star.))%%2
star.[even,]
effects[even,]
effects
even
odd <- sequence(from = 1, by = 2, to = length(stat))
odd <- seq(from = 1, by = 2, to = length(stat))
odd
odd <- seq(from = 1, by = 2, to = length(stat)+1)
odd
effects[odd,]
effects[!odd,]
even
effects[!even,]
effects[even,]
effects[as.logical(even),]
effects <- t(round(summary(x, type = type, horizon = horizon)[, paste(stat)], digits = digits))
effects
y <- rnorm(800, sd = 1)
y <- y -2*x1 + x2
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.40
ce <- CausalArima(y = ts(y.new, start = start, frequency = 7), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
table(ce, type = "norm", stat = "avg", horizon = horizon)
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
table(ce, type = "norm", stat = "avg", horizon = horizon)
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.90
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
table(ce, type = "norm", stat = "avg", horizon = horizon)
x1 <- rnorm(800, mean = 2, sd = 0.5)
x2 <- rnorm(800, mean = 3, sd = 0.5)
y <- y -2*x1 + x2
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.90
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
table(ce, type = "norm", stat = "avg", horizon = horizon)
sumry <- summary(x, type = type, horizon = horizon)[, paste("pvalue.", stat, ".", direction, sep = "")]
star. <- apply(sumry, 2, FUN = ".star")
direction <- "b"
sumry <- summary(x, type = type, horizon = horizon)[, paste("pvalue.", stat, ".", direction, sep = "")]
star.
x <- ce
sumry <- summary(x, type = type, horizon = horizon)[, paste("pvalue.", stat, ".", direction, sep = "")]
star. <- apply(sumry, 2, FUN = ".star")
star.
star.[2,1] <- "***"
star.[1,2] <- "*"
star.
effects <- round(summary(x, type = type, horizon = horizon)[, paste(stat)], digits = digits)
effects
apply(effects, 2, FUN = paste(effects, 2, star.))
apply(effects, 2, FUN = paste(x)(effects, 2, star.))
apply(effects, 2, FUN = function(x){paste(effects, 2, star.)})
apply(effects, 2, FUN = function(x){paste0(effects, 2, star.)})
apply(effects, 2, FUN = function(x){paste(x, star.)})
apply(effects, 2, FUN = function(x){paste0(x, star.)})
paste(effects, star.)
apply(effects, 2, FUN = function(x){paste(effects, 2, star.)})
apply(effects, 2, FUN = function(x){paste(x, 2, star.)})
c(effects)
as.vector(effects)
class(effects)
unlist(effects)
unlist(star.)
class(star.)
c(unlist(star.))
paste(unlist(effects), c(unlist(star.)))
matrix(paste0(unlist(effects), c(unlist(star.))), byrow = F)
matrix(paste0(unlist(effects), c(unlist(star.))), nrow = 2, ncol = 3, byrow = T)
effects
star.
sd <- paste("(",round(summary(x, type = type, horizon = horizon)[, paste("sd.", stat, sep = "")], digits = digits),")", sep = "")
sd
sd <- round(summary(x, type = type, horizon = horizon)[, paste("sd.", stat, sep = "")], digits = digits)
sd
apply(sd, function(x)(paste("(",x,")")))
apply(sd, 2, FUN = function(x)(paste("(",x,")")))
apply(sd, 2, FUN = function(x)(paste0("(",x,")")))
t(apply(sd, 2, FUN = function(x)(paste0("(",x,")"))))
sd <- round(summary(x, type = type, horizon = horizon)[, paste("sd.", stat, sep = "")], digits = digits)
sd <- t(apply(sd, 2, FUN = function(x)(paste0("(", x, ")"))))
tab_norm <- matrix(NA, nrow = 2*length(stat), ncol = length(horizon))
even <- as.logical(seq_len(nrow(tab_norm))%%2)
even
tab
effects <- round(summary(x, type = type, horizon = horizon)[, paste(stat)], digits = digits)
tab <- matrix(paste0(unlist(effects), c(unlist(star.))), nrow = length(stat), ncol = length(horizon), byrow = T)
rownames(tab) <- stat
colnames(tab) <- horizon
tab
colnames(tab) <- paste(horizon)
tab
tab_norm[even, ] <- tab
tab_norm[!even, ] <- sd
tab_norm
rownames(tab_norm[even, ]) <- rownames(tab)
tab_norm
names <- c(stat, paste0(stat, ".sd"))
names
tab <- tab_norm
colnames(tab) <- paste(horizon)
rownames(tab) <- names[order(names, decreasing = T)]
tab
rownames(tab) <- names[order(names, decreasing = F)]
tab
library(CausalArima)
y <- rnorm(800, sd = 1)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 0.5)
x2 <- rnorm(800, mean = 3, sd = 0.5)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.40
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Table of the estimated temporal average effects
table(ce, type = "norm", stat = "avg", horizon = horizon)
base::table
ce$model$arma
summary(ce, type = "norm", horizon = horizon)
summary(ce, type = "norm", horizon = horizon)[,"avg"] + summary(ce, type = "norm", horizon = horizon)[,"sd.avg"]*qnorm(0.975)
qnorm(0.975)
qnorm(0.025)
2*(summary(ce, type = "norm", horizon = horizon)[,"avg"] + summary(ce, type = "norm", horizon = horizon)[,"sd.avg"]*qnorm(0.975))
2*(summary(ce, type = "norm", horizon = horizon)[,"sd.avg"]*qnorm(0.975))
prova <- lm(y ~ x1+x2 )
summary(prova)
summary(prova)$coefficients
summary(prova)$coefficients[, 4]
summary(prova)$coefficients[, "Pr(>|t|)"]
summary(prova)$coefficients[, "Pr(>|t|)"] <= 0
summary(prova)$coefficients[, "Pr(>|t|)"] <= 0.05
y <- 0.5*seq(0.5, 250, by = 0.5) + rnorm(500, sd = 6)
dates <- seq.Date(from = as.Date("2014-01-05"), by = "days", length.out = 500)
# Adding a fictional intervention
int.date <- as.Date("2015-04-01")
horizon <- c(as.Date("2015-04-10"), as.Date("2015-04-20"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.25
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic",
dates = dates, int.date = int.date)
library(CausalArima)
y <- 0.5*seq(0.5, 250, by = 0.5) + rnorm(500, sd = 6)
dates <- seq.Date(from = as.Date("2014-01-05"), by = "days", length.out = 500)
# Adding a fictional intervention
int.date <- as.Date("2015-04-01")
horizon <- c(as.Date("2015-04-10"), as.Date("2015-04-20"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.25
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic",
dates = dates, int.date = int.date,
nboot = 10)
length(ce$causal.effect)
plot(ce$causal.effect +ca$norm$inf[, "sd.tau"]*qnorm(0.975), type = "l")
plot(ce$causal.effect +ce$norm$inf[, "sd.tau"]*qnorm(0.975), type = "l")
plot(ce$causal.effect +ce$norm$inf[, "sd.tau"]*qnorm(0.975), type = "l", ylim = c(0, 100))
lines(ce$causal.effect - ce$norm$inf[, "sd.tau"]*qnorm(0.975))
lines(ce$causal.effect, col = "blue")
prova <- auto.arima(y_new)
prova <- auto.arima(y.new)
coefficients(prova)
print(prova)
summary(prova)
prova$coef
y <- rnorm(800, sd = 1)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 0.5)
x2 <- rnorm(800, mean = 3, sd = 0.5)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.40
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Table of the estimated temporal average effects
table(ce, type = "norm", stat = "avg", horizon = horizon)
library(CausalArima)
y <- rnorm(800, sd = 1)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 0.5)
x2 <- rnorm(800, mean = 3, sd = 0.5)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.40
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Table of the estimated temporal average effects
table(ce, type = "norm", stat = "avg", horizon = horizon)
