library(CausalArima)
library(CausalArima)
y <- rnorm(800, sd = 1)
dates <- seq.Date(from = as.Date("2005-01-01"), by = "week", length.out = 800)
# Generating predictors
x1 <- rnorm(800, mean = 2, sd = 0.5)
x2 <- rnorm(800, mean = 3, sd = 0.5)
y <- y -2*x1 + x2
# Adding a fictional intervention
int.date <- as.Date("2019-05-11")
horizon <- c(as.Date("2019-12-07"), as.Date("2020-02-15"), as.Date("2020-04-25"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.40
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic", dates = dates, xreg = data.frame(x1,x2), int.date = int.date)
# Table of the estimated temporal average effects
impact(ce)
data(sales)
sales$Dates <- as.Date(sales$Dates, format = "%Y-%m-%d")
# install.packages(c("devtools", "kableExtra","tseries" ))
# devtools::install_github("FMenchetti/CausalArima")
library("CausalArima")
library("kableExtra")
library("tseries")
data(sales)
sales$Dates <- as.Date(sales$Dates, format = "%Y-%m-%d")
int.date <- as.Date("2018-10-04", format = "%Y-%m-%d")
dates <- sales$Dates
y <- sales$Sales
ggplot(data = sales, aes(x = Dates, y1 = TruePrice, y2 = Price)) +
geom_line(y2) +
geom_vline(xintercept = int.date,
linetype = "dashed",
color = "red", size = 1)
ggplot(data = sales, aes(x = Dates, y1 = TruePrice, y2 = Price)) +
geom_line(Price) +
geom_vline(xintercept = int.date,
linetype = "dashed",
color = "red", size = 1)
ggplot(data = sales, aes(x = Dates)) +
geom_line(aes(y = Price)) +
geom_line(aes(y = TruePrice)))
ggplot(data = sales, aes(x = Dates)) +
geom_line(aes(y = Price)) +
geom_line(aes(y = TruePrice))
ggplot(data = sales, aes(x = Dates)) +
geom_line(aes(y = Price), linetype = "dashed", color = "blue") +
geom_line(aes(y = TruePrice))
ggplot(data = sales, aes(x = Dates)) +
geom_line(aes(y = Price), linetype = "dashed", color = "blue") +
geom_line(aes(y = TruePrice)) +
geom_vline(aes(xintercept = int.date),
linetype = "dashed",
color = "red", size = 1)
prova <- sales[, -"Price"]
prova <- sales[, - which(colnames(sales)== "Price")]
colnames(prova)
X_new <- X
horizon <- c(int.date + 7, int.date + 30, int.date + 90)
Y <- ts(y, frequency = 7) # response variable, weekly data
X <- sales[, c("Price","hol", "dec.sun","sat","sun","mon", "tue","wed", "thr") ]
X_new <- X
X_new$log_Price <- log(X_new$Price)
X_new$Price <- NULL
View(X_new)
set.seed(1)
x1 <- 100 + arima.sim(model = list(ar = 0.999), n = 100)
y <- 1.2 * x1 + rnorm(100)
y[71:100] <- y[71:100] + 10
data <- cbind(y, x1)
time.points <- seq.Date(as.Date("2014-01-01"), by = 1, length.out = 100)
time.points[71]
library(CausalArima)
y <- 0.5*seq(0.5, 250, by = 0.5) + rnorm(500, sd = 6)
dates <- seq.Date(from = as.Date("2014-01-05"), by = "days", length.out = 500)
# Adding a fictional intervention
int.date <- as.Date("2015-04-01")
horizon <- c(as.Date("2015-04-10"), as.Date("2015-04-20"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.25
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Plot
plot(ce, type = "forecast")
plot(ce, type = "forecast", horizon = horizon)
library(CausalArima)
y <- 0.5*seq(0.5, 250, by = 0.5) + rnorm(500, sd = 6)
dates <- seq.Date(from = as.Date("2014-01-05"), by = "days", length.out = 500)
# Adding a fictional intervention
int.date <- as.Date("2015-04-01")
horizon <- c(as.Date("2015-04-10"), as.Date("2015-04-20"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.25
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Plot
plot(ce, type = "forecast")
plot(ce, type = "forecast", horizon = horizon)
library(CausalArima)
y <- 0.5*seq(0.5, 250, by = 0.5) + rnorm(500, sd = 6)
dates <- seq.Date(from = as.Date("2014-01-05"), by = "days", length.out = 500)
# Adding a fictional intervention
int.date <- as.Date("2015-04-01")
horizon <- c(as.Date("2015-04-10"), as.Date("2015-04-20"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.25
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Plot
plot(ce, type = "forecast")
y <- 0.5*seq(0.5, 250, by = 0.5) + rnorm(500, sd = 6)
dates <- seq.Date(from = as.Date("2014-01-05"), by = "days", length.out = 500)
# Adding a fictional intervention
int.date <- as.Date("2015-04-01")
horizon <- c(as.Date("2015-04-10"), as.Date("2015-04-20"))
y.new <- y ; y.new[dates >= int.date] <- y.new[dates >= int.date]*1.25
# Causal effect estimation
start<-as.numeric(strftime(as.Date(dates[1], "%Y-%m-%d"), "%u"))
ce <- CausalArima(y = ts(y.new, start = start, frequency = 1), auto = TRUE, ic = "aic", dates = dates, int.date = int.date)
# Plot
plot(ce, type = "forecast")
plot(ce, type = "forecast", horizon = horizon)
